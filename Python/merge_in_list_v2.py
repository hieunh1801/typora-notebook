data = [{'country_rating_point': 0, 'created_date': '2019-12-17', 'enable_filter': 1, 'enable_news_domains': 0, 'face_url': None, 'filter_condition': {'en_term': 'United Nations General Assembly,UNGA', 'vi_term': 'Đại Hội Đồng Liên Hiệp Quốc, UNGA'}, 'geo_shape_file': None, 'image_path': './static/admin/monitors_objects/2019_12_17_UNGE.svg.png', 'last_updated': '2019-12-17', 'neo4j_label': 'UNGA ', 'news_collection': 'news_of_object_3', 'object_describe': None, 'object_description': 'Thông tin về Đại Hội Đồng Liên Hiệp Quốc', 'object_id': 3, 'object_name': 'Đại Hội Đồng Liên Hiệp Quốc', 'object_subtype': None, 'object_type': 'Organization', 'privilege': '1,1,1,1,1,1', 'profile_url': 'https://en.wikipedia.org/wiki/United_Nations_General_Assembly', 'required_role': None, 'resource_id': 60, 'sent_collection': 'news_sent_3', 'specific_id': 3, 'status': 1, 'table_name': 'monitor_objects', 'tenant_id': None, 'twitter_url': None, 'user_id': 1, 'user_resource_id': 960}, {'country_rating_point': 0, 'created_date': '2019-12-17', 'enable_filter': 1, 'enable_news_domains': 0, 'face_url': 'https://www.facebook.com/unitednations/', 'filter_condition': {'cn_term': '', 'en_term': 'United Nations', 'ru_term': '', 'vi_term': ' Liên Hợp Quốc, UN'}, 'geo_shape_file': None, 'image_path': './static/admin/monitors_objects/2019_12_17_LHQ.png', 'last_updated': '2019-12-17', 'neo4j_label': 'UN', 'news_collection': 'news_of_object_2', 'object_describe': None, 'object_description': 'Thông tin về Liên Hợp Quốc', 'object_id': 2, 'object_name': 'Liên Hợp Quốc', 'object_subtype': None, 'object_type': 'Organization', 'privilege': '2', 'profile_url': 'https://en.wikipedia.org/wiki/United_Nations', 'required_role': None, 'resource_id': 59, 'sent_collection': 'news_sent_2', 'specific_id': 2, 'status': 0, 'table_name': 'monitor_objects', 'tenant_id': None, 'twitter_url': '', 'user_id': 1, 'user_resource_id': 954}, {'country_rating_point': 0, 'created_date': '2019-12-16', 'enable_filter': 1, 'enable_news_domains': 0, 'face_url': '', 'filter_condition': {'en_term': 'Tap Can Binh', 'vi_term': 'Tập Cận Bình'}, 'geo_shape_file': 'string', 'image_path': './static/admin/monitors_objects/2019_12_18_Xi_Jinping_2019.jpg', 'last_updated': '2019-12-16', 'neo4j_label': 'Tập Cận Bình', 'news_collection': 'news_of_object_1', 'object_describe': 'string', 'object_description': 'Tập Cận Bình (sinh ngày 15 tháng 6 năm 1953) là nhà lãnh đạo quốc gia tối cao của Trung Quốc. Ông hiện là Tổng Bí thư Ủy ban Trung ương Đảng Cộng sản Trung Quốc, Chủ tịch Ủy ban Quân sự Trung ương Đảng Cộng sản Trung Quốc.', 'object_id': 1, 'object_name': 'Tập Cận Bình', 'object_subtype': 'string', 'object_type': 'Person', 'privilege': '1', 'profile_url': 'https://vi.wikipedia.org/wiki/T%E1%BA%ADp_C%E1%BA%ADn_B%C3%ACnh', 'required_role': None, 'resource_id': 13, 'sent_collection': 'news_sent_1', 'specific_id': 1, 'status': 1, 'table_name': 'monitor_objects', 'tenant_id': 0, 'twitter_url': '', 'user_id': 1, 'user_resource_id': 953}, {'country_rating_point': 0, 'created_date': '2019-12-17', 'enable_filter': 1, 'enable_news_domains': 0, 'face_url': None, 'filter_condition': {'en_term': 'United Nations Secretariat', 'vi_term': 'Ban thư ký Liên hợp quốc'}, 'geo_shape_file': None, 'image_path': './static/admin/monitors_objects/2019_12_17_UNGE.svg.png', 'last_updated': '2019-12-17', 'neo4j_label': None, 'news_collection': 'news_of_object_6', 'object_describe': None, 'object_description': 'Thông tin về Ban thư ký Liên hợp quốc', 'object_id': 6, 'object_name': 'Ban thư ký Liên hợp quốc', 'object_subtype': None, 'object_type': 'Organization', 'privilege': '2', 'profile_url': 'https://en.wikipedia.org/wiki/United_Nations_Secretariat', 'required_role': None, 'resource_id': 63, 'sent_collection': 'news_sent_6', 'specific_id': 6, 'status': 0, 'table_name': 'monitor_objects', 'tenant_id': None, 'twitter_url': None, 'user_id': 1, 'user_resource_id': 952}, {'country_rating_point': 0, 'created_date': '2019-12-17', 'enable_filter': 1, 'enable_news_domains': 0, 'face_url': '', 'filter_condition': {'cn_term': '', 'en_term': 'United Nations Economic and Social Council,ECOSOC', 'ru_term': '', 'vi_term': 'Hội đồng Kinh tế và Xã hội Liên Hợp Quốc,ECOSOC'}, 'geo_shape_file': None, 'image_path': './static/admin/monitors_objects/2019_12_17_UNGE.svg.png', 'last_updated': '2019-12-17', 'neo4j_label': 'ECOSOC', 'news_collection': 'news_of_object_5', 'object_describe': None, 'object_description': 'Thông tin về Hội đồng Kinh tế và Xã hội Liên Hợp Quốc', 'object_id': 5, 'object_name': 'Hội đồng Kinh tế và Xã hội Liên Hợp Quốc', 'object_subtype': None, 'object_type': 'Organization', 'privilege': '1', 'profile_url': 'https://en.wikipedia.org/wiki/United_Nations_Economic_and_Social_Council', 'required_role': None, 'resource_id': 62, 'sent_collection': 'news_sent_5', 'specific_id': 5, 'status': 0, 'table_name': 'monitor_objects', 'tenant_id': None, 'twitter_url': '', 'user_id': 1, 'user_resource_id': 951}, {'country_rating_point': 0, 'created_date': '2019-12-17', 'enable_filter': 1, 'enable_news_domains': 0, 'face_url': None, 'filter_condition': {'en_term': 'United Nations Security Council,UNSC', 'vi_term': 'Hội đồng Bảo an Liên Hợp Quốc, UNSC'}, 'geo_shape_file': None, 'image_path': './static/admin/monitors_objects/2019_12_17_UNGE.svg.png', 'last_updated': '2019-12-17', 'neo4j_label': 'UNSC', 'news_collection': 'news_of_object_4', 'object_describe': None, 'object_description': 'Thông tin về Hội đồng Bảo an Liên Hợp Quốc', 'object_id': 4, 'object_name': 'Hội đồng Bảo an Liên Hợp Quốc', 'object_subtype': None, 'object_type': 'Organization', 'privilege': '2', 'profile_url': 'https://en.wikipedia.org/wiki/United_Nations_Security_Council', 'required_role': None, 'resource_id': 61, 'sent_collection': 'news_sent_4', 'specific_id': 4, 'status': 1, 'table_name': 'monitor_objects', 'tenant_id': None, 'twitter_url': None, 'user_id': 1, 'user_resource_id': 950}, {'country_rating_point': 0, 'created_date': '2019-12-17', 'enable_filter': 1, 'enable_news_domains': 0, 'face_url': None, 'filter_condition': {'en_term': 'United Nations General Assembly,UNGA', 'vi_term': 'Đại Hội Đồng Liên Hiệp Quốc, UNGA'}, 'geo_shape_file': None, 'image_path': './static/admin/monitors_objects/2019_12_17_UNGE.svg.png', 'last_updated': '2019-12-17', 'neo4j_label': 'UNGA ', 'news_collection': 'news_of_object_3', 'object_describe': None, 'object_description': 'Thông tin về Đại Hội Đồng Liên Hiệp Quốc', 'object_id': 3, 'object_name': 'Đại Hội Đồng Liên Hiệp Quốc', 'object_subtype': None, 'object_type': 'Organization', 'privilege': '1', 'profile_url': 'https://en.wikipedia.org/wiki/United_Nations_General_Assembly', 'required_role': None, 'resource_id': 60, 'sent_collection': 'news_sent_3', 'specific_id': 3, 'status': 1, 'table_name': 'monitor_objects', 'tenant_id': None, 'twitter_url': None, 'user_id': 1, 'user_resource_id': 949}, {'country_rating_point': 0, 'created_date': '2019-12-17', 'enable_filter': 1, 'enable_news_domains': 0, 'face_url': 'https://www.facebook.com/unitednations/', 'filter_condition': {'cn_term': '', 'en_term': 'United Nations', 'ru_term': '', 'vi_term': ' Liên Hợp Quốc, UN'}, 'geo_shape_file': None, 'image_path': './static/admin/monitors_objects/2019_12_17_LHQ.png', 'last_updated': '2019-12-17', 'neo4j_label': 'UN', 'news_collection': 'news_of_object_2', 'object_describe': None, 'object_description': 'Thông tin về Liên Hợp Quốc', 'object_id': 2, 'object_name': 'Liên Hợp Quốc', 'object_subtype': None, 'object_type': 'Organization', 'privilege': '2', 'profile_url': 'https://en.wikipedia.org/wiki/United_Nations', 'required_role': None, 'resource_id': 59, 'sent_collection': 'news_sent_2', 'specific_id': 2, 'status': 0, 'table_name': 'monitor_objects', 'tenant_id': None, 'twitter_url': '', 'user_id': 1, 'user_resource_id': 948}, {'country_rating_point': 0, 'created_date': '2019-12-17', 'enable_filter': 1, 'enable_news_domains': 0, 'face_url': None, 'filter_condition': {'en_term': 'United Nations General Assembly,UNGA', 'vi_term': 'Đại Hội Đồng Liên Hiệp Quốc, UNGA'}, 'geo_shape_file': None, 'image_path': './static/admin/monitors_objects/2019_12_17_UNGE.svg.png', 'last_updated': '2019-12-17', 'neo4j_label': 'UNGA ', 'news_collection': 'news_of_object_3', 'object_describe': None, 'object_description': 'Thông tin về Đại Hội Đồng Liên Hiệp Quốc', 'object_id': 3, 'object_name': 'Đại Hội Đồng Liên Hiệp Quốc', 'object_subtype': None, 'object_type': 'Organization', 'privilege': '1,2', 'profile_url': 'https://en.wikipedia.org/wiki/United_Nations_General_Assembly', 'required_role': None, 'resource_id': 60, 'sent_collection': 'news_sent_3', 'specific_id': 3, 'status': 1, 'table_name': 'monitor_objects', 'tenant_id': None, 'twitter_url': None, 'user_id': 1, 'user_resource_id': 947}]
"""
    Truong identity
        - user_id
        - resource_id
    Merge tren truong
        - privilege
"""
def merge_two_number(a: int, b: int):
    """
        :params: a = 1; b = 2
        return "1,2"
    """
    return f"{a},{b}"

def merge_duplicate_in_list(data):
    list_result = []
    while data != []:
        list_result.append(data.pop())
        list_result[-1]["privilege"] = str(list_result[-1]["privilege"])
        while (data != []) \
            and (data[-1]["user_id"] == list_result[-1]["user_id"] and data[-1]["resource_id"] == list_result[-1]["resource_id"]):
            list_result[-1]["privilege"] = merge_two_number(
                list_result[-1]["privilege"], data[-1].get("privilege"))
            data.pop()
    return list_result

print(merge_duplicate_in_list(data))